<!DOCTYPE html><!--[if IE 8]> <html lang="en" class="ie8"> <![endif]--><!--[if IE 9]> <html lang="en" class="ie9"> <![endif]--><!--[if !IE]><!--> <html lang="en"> <!--<![endif]--><!-- BEGIN HEAD --><head>    <meta charset="UTF-8">    <meta name="viewport"          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">    <meta http-equiv="X-UA-Compatible" content="ie=edge">    <meta content="" name="description" />    <meta content="" name="author" />    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />    <link href="../assets/font-awesome/css/font-awesome.css" rel="stylesheet" />    <link href="../css/style.css" rel="stylesheet" />    <link href="../css/style_responsive.css" rel="stylesheet" />    <link href="../css/style_default.css" rel="stylesheet" id="style_color" />    <link rel="stylesheet" type="text/css" href="../assets/gritter/css/jquery.gritter.css" />    <link href="../assets/fancybox/source/jquery.fancybox.css" rel="stylesheet" />    <title>用户注册</title></head><body class="fixed-top"><div class="login-header">    <!-- BEGIN LOGO -->    <div id="logo" class="center">        <img src="../../img/logo.png" alt="Tencent" class="center" />    </div>    <!-- END LOGO --></div><!-- BEGIN LOGIN --><div class="container-fluid">    <div class="row-fluid">       <div class="span12">           <div class="widget">               <div class="widget-title">                   <h4><i class="icon-reorder"></i>用户注册</h4>                   <span class="tools">                           <a href="javascript:;" class="icon-chevron-down"></a>                           <a href="javascript:;" class="icon-remove"></a>                    </span>               </div>               <div class="widget-body form">                   <!-- BEGIN FORM-->                   <form action="#" class="form-horizontal"><!--                       <div class="control-group">--><!--                           <label class="control-label" for="factory_id">工厂名称</label>--><!--                           <div class="controls">--><!--                               <input type="text" class="span6" id="factory_id">--><!--                               <span class="help-inline"></span>--><!--                               <p class="help-block"></p>--><!--                           </div>--><!--                       </div>-->                       <div class="control-group">                           <label class="control-label">工厂名称</label>                           <div class="controls">                               <select class="span6 " data-placeholder="Choose a Category" tabindex="1" id="factory_id">                               </select>                              <span class="help-inline"></span>                              <p class="help-block"></p>                           </div>                       </div>                       <div class="control-group ">                           <label class="control-label" for="user_name">用户名</label>                           <div class="controls">                               <input type="text" class="span6" id="user_name">                               <span class="help-inline"></span>                               <p class="help-block"></p>                           </div>                       </div>                       <div class="control-group">                           <label class="control-label" for="user_real_name">用户真实姓名</label>                           <div class="controls">                               <input type="text" class="span6" id="user_real_name">                               <span class="help-inline"></span>                               <p class="help-block"></p>                           </div>                       </div>                       <div class="control-group">                           <label class="control-label" for="user_job_num">用户工号</label>                           <div class="controls">                               <input type="text" class="span6" id="user_job_num">                               <span class="help-inline"></span>                               <p class="help-block"></p>                           </div>                       </div>                       <div class="control-group">                           <label class="control-label" for="user_phone_num">用户手机</label>                           <div class="controls">                               <input type="number" class="span6" id="user_phone_num" maxlength="11" minlength="11">                               <span class="help-inline"></span>                               <p class="help-block"></p>                           </div>                       </div>                       <div class="control-group">                           <label class="control-label" for="user_email">用户邮箱</label>                           <div class="controls">                               <div class="input-icon left">                                   <i class="icon-envelope"></i>                                   <input class=" " type="email" placeholder="邮箱地址" id="user_email">                                   <span class="help-inline"></span>                                   <p class="help-block"></p>                               </div>                           </div>                       </div>                       <div class="control-group">                           <label class="control-label" for="user_passwd">密码</label>                           <div class="controls">                               <input type="password" class="span6" id="user_passwd">                               <span class="help-inline"></span>                               <p class="help-block"></p>                           </div>                       </div>                       <div class="control-group">                           <label class="control-label" for="user_confirm_passwd">确定密码</label>                           <div class="controls">                               <input type="password" class="span6" id="user_confirm_passwd">                               <span class="help-inline"></span>                               <p class="help-block"></p>                           </div>                       </div>                       <div class="control-group">                           <label class="control-label" for="remarks">备注</label>                           <div class="controls">                               <textarea class="span6 " rows="3" id="remarks"></textarea>                               <span class="help-inline"></span>                               <p class="help-block"></p>                           </div>                       </div>                       <div class="form-actions">                           <button type="button" class="btn btn-success" id="submit_insert">提交</button><!--                           <button type="reset" class="btn">Cancel</button>-->                       </div>                   </form>                   <!-- END FORM-->               </div>           </div>       </div>   </div></div><!-- END LOGIN --><!-- BEGIN COPYRIGHT --><div id="login-copyright">   2019 &copy; 腾讯.智能制造.云平台</div><!-- END COPYRIGHT --><!-- BEGIN JAVASCRIPTS --><script src="../js/jquery-1.8.3.min.js"></script><script src="../assets/bootstrap/js/bootstrap.min.js"></script><script src="../js/jquery.blockui.js"></script><!-- ie8 fixes --><!--[if lt IE 9]><script src="../js/excanvas.js"></script><script src="../js/respond.js"></script><![endif]--><script src="../assets/gritter/js/jquery.gritter.js"></script><script src="../js/scripts.js"></script><script>   $(function () {        /**         * 原始代码，建议勿动         */        App.init();       /**        * 用户输入验证等级 在control-group 上加上对应的class        * warning 黄色警告 以下均包括字体 输入框        * error 黄色错误        * success 绿色成功        *        * factory_id 工厂名称        * user_name 用户名        * user_real_name 用户真实姓名        * user_job_num 用户工号        * user_phone_num 用户手机        * user_email 用户邮箱        * user_passwd 密码        * user_confirm_passwd 确定密码        * remarks 备注        */       $.ajax({           url:"/getAllFactoryIds",           type:"POST",           data:{},           dataType:"json",           beforeSend:function (XMLHttpRequest) {},           success:function (data,textStatus,XMLHttpRequest) {               data.forEach(function (element,index) {                   $("#factory_id").append('<option value="'+element+'">'+element+'</option>')               })           },           error:function (XMLHttpRequest,textStatus,errorThorwn) {               console.error(XMLHttpRequest);               console.error(textStatus);               console.error(errorThorwn);           },           complete:function (XMLHttpRequest,textStatus) {}       });       /**        * 输入框获取焦点则删除验证        */       let vef_result = false;       function veFocus(id){           $("#" + id).focus(function () {               let $this = $(this);               if(                   $this.parents(".control-group").hasClass("warning")                   || $this.parents(".control-group").hasClass("error")                   || $this.parents(".control-group").hasClass("success")               ){                   $this.parents(".control-group").removeClass("warning");                   $this.parents(".control-group").removeClass("error");                   $this.parents(".control-group").removeClass("success");                   $this.next(".help-inline").text("");                   $this.next().next(".help-block").text("");               }           });       }       // veFocus("factory_id");       veFocus("user_name");       veFocus("user_real_name");       veFocus("user_job_num");       veFocus("user_phone_num");       veFocus("user_email");       veFocus("user_passwd");       veFocus("user_confirm_passwd");       veFocus("remarks");       /**        * 输入框失去焦点则删除验证        */       /**        * 输入框非空验证        * @param id        * @returns {boolean}        */       function isEmpty(id) {           if($("#" + id).val().trim() == ""){               return true           }else {               return false;           }       }       function veBlue(id){           $("#" + id).blur(function () {               let $this = $(this);               if(id != "remarks" && isEmpty(id)){                   $this.parents(".control-group").addClass("error");                   $this.next(".help-inline").text(                       $this.parents(".control-group").                       children(".control-label").text() + "不能为空");                   vef_result = false;                   return;               }               switch (id) {                   case "factory_id":                       //名称长度不超过 10                       //后续视情况而定是否需要查询工厂是否存在                       if($this.val().length <= 10){                           $this.parents(".control-group").addClass("success");                           $this.next(".help-inline").text("验证通过");                           vef_result = true;                       }else {                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text(                               $this.parents(".control-group").                               children(".control-label").text() + ": 长度不能超过10");                           vef_result = false;                           return;                       }                       break;                   case "user_name":                       //此自应该ajax发送请求判断用户名是否已经存在                       //名称长度不超过 10                       if($this.val().length <= 10){                           $.ajax({                               url:"/isExistUsername",                               type:"POST",                               data:{                                   username:$this.val()                               },                               dataType:"json",                               beforeSend:function (XMLHttpRequest) {},                               success:function (data,textStatus,XMLHttpRequest) {                                   if(data){                                       //true 用户名可用                                       $this.parents(".control-group").addClass("success");                                       $this.next(".help-inline").text("验证通过");                                       vef_result = true;                                   }else{                                       //false 用户名不可用                                       $this.parents(".control-group").addClass("error");                                       $this.next(".help-inline").text("用户名已存在");                                       vef_result = false;                                       return;                                   }                               },                               error:function (XMLHttpRequest,textStatus,errorThorwn) {                                   console.error(XMLHttpRequest);                                   console.error(textStatus);                                   console.error(errorThorwn);                                   //登录失败                                   $this.parents(".control-group").addClass("error");                                   $this.next(".help-inline").text("验证失败，请重新输入进行验证");                                   vef_result = false;                                   return;                               },                               complete:function (XMLHttpRequest,textStatus) {}                           })                       }else {                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text(                               $this.parents(".control-group").                               children(".control-label").text() + ": 长度不能超过10");                           vef_result = false;                           return;                       }                       break;                   case "user_real_name":                       //名称长度不超过 10                       if($this.val().length <= 10){                           $this.parents(".control-group").addClass("success");                           $this.next(".help-inline").text("验证通过");                           vef_result = true;                       }else {                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text(                               $this.parents(".control-group").                               children(".control-label").text() + ": 长度不能超过10");                           vef_result = false;                           return;                       }                       break;                   case "user_job_num":                       break;                   case "user_phone_num":                       //手机号必须为11位                       if($this.val().length == 11){                           $this.parents(".control-group").addClass("success");                           $this.next(".help-inline").text("验证通过");                           vef_result = true;                       }else {                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text(                               $this.parents(".control-group").                               children(".control-label").text() + ": 长度必须为11");                           vef_result = false;                           return;                       }                       break;                   case "user_email":                       //邮箱验证                       if($this.val().indexOf(".") != -1 &&                           $this.val().indexOf(".") != ($this.val().length - 1) &&                           $this.val().indexOf("@") != -1){                           $this.parents(".control-group").addClass("success");                           $this.next(".help-inline").text("验证通过");                           vef_result = true;                       }else {                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text(                               $this.parents(".control-group").                               children(".control-label").text() + ": 不合法");                           vef_result = false;                           return;                       }                       break;                   case "user_passwd":                       //密码6 ~ 15位                       if($this.val().length >= 6 && $this.val().length <= 15){                           $this.parents(".control-group").addClass("success");                           $this.next(".help-inline").text("验证通过");                           vef_result = true;                       }else {                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text(                               $this.parents(".control-group").                               children(".control-label").text() + ": 长度必须在6到15位之间");                           vef_result = false;                           return;                       }                       break;                   case "user_confirm_passwd":                       //密码6 ~ 15位 且必须与第 一次一样                       if($this.val() != $("#user_passwd").val()){                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text("两次密码输入不一致");                           vef_result = false;                           return;                       }else {                           $this.parents(".control-group").addClass("success");                           $this.next(".help-inline").text("验证通过");                           vef_result = true;                       }                       break;                   case "remarks":                       //长度不得超过140个字                       if($this.val().length < 140){                           $this.parents(".control-group").addClass("success");                           $this.next(".help-inline").text("验证通过");                           vef_result = true;                       }else {                           $this.parents(".control-group").addClass("error");                           $this.next(".help-inline").text(                               $this.parents(".control-group").                               children(".control-label").text() + ": 长度不能超过140"                           );                           vef_result = false;                           return;                       }                       break;                   default:                       console.error("id: " +id + " 未找到");                       vef_result = false;                       return;               }           });       }       veBlue("factory_id");       veBlue("user_name");       veBlue("user_real_name");       veBlue("user_job_num");       veBlue("user_phone_num");       veBlue("user_email");       veBlue("user_passwd");       veBlue("user_confirm_passwd");       veBlue("remarks");       $("#submit_insert").click(function () {           const factory_id = $("#factory_id").val(),               user_name = $("#user_name").val(),               user_real_name = $("#user_real_name").val(),               user_job_num = $("#user_job_num").val(),               user_phone_num = $("#user_phone_num").val(),               user_email = $("#user_email").val(),               user_passwd = $("#user_passwd").val(),               user_confirm_passwd = $("#user_confirm_passwd").val(),               remarks = $("#remarks").val();           if(vef_result){               $.ajax({                   url:"/insertIntoTsmcpUser",                   type:"POST",                   data:{                       factoryId:factory_id,                       userName:user_name,                       userRealName:user_real_name,                       userJobNum:user_job_num,                       userPhoneNum:user_phone_num,                       userEmail:user_email,                       userPasswd:user_passwd,                       remarks:remarks                   },                   dataType:"json",                   beforeSend:function (XMLHttpRequest) {},                   success:function (data,textStatus,XMLHttpRequest) {                       if(data){                           //true 插入成功                           $.gritter.add({                               title: '',                               text: '注册成功，3秒之后即将为您跳到登陆页面'                           });                           setTimeout(function () {                               location.href = "../login.html";                           },3000)                       }else {                           //false 插入失败                           $.gritter.add({                               title: '',                               text: '注册失败,稍后请重新注册'                           });                       }                   },                   error:function (XMLHttpRequest,textStatus,errorThorwn) {                       console.error(XMLHttpRequest);                       console.error(textStatus);                       console.error(errorThorwn);                       //false 插入失败                       $.gritter.add({                           title: '',                           text: '注册失败,稍后请重新注册'                       });                   },                   complete:function (XMLHttpRequest,textStatus) {}               });           }else {               $.gritter.add({                   title: '',                   text: '请检查输入是否有误'               });           }       });   });</script><!-- END JAVASCRIPTS --></body></html>